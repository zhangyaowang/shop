<!DOCTYPE HTML>
<html>
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
  <meta charset="UTF-8">

  <link rel="shortcut icon" href="images/favicon.html">
  <meta name="description" content="">
  <meta name="keywords" content="">

  <title>{$title}</title>

  <link rel="shortcut icon" href="favicon.ico">
  {load href="__CSS__/grid.css" /}
	{load href="__CSS__/jquery.jqzoom.css" /}
	{load href="__CSS__/style.css" /}
 
  <script src="/static/js/jquery-1.7.2.min.js" ></script>
  <script src="/static/js/html5.js" ></script>
  <script src="/static/js/jflow.plus.js"></script>
  <script src="/static/js/jquery.carouFredSel-5.2.2-packed.js"></script>
  <script src="/static/js/checkbox.js"></script>
  <script src="/static/js/radio.js"></script>
  <script src="/static/js/selectBox.js"></script>

  <script>
	$(document).ready(function() {
		$("select").selectBox();
	});
  </script>

  <script>
	$(document).ready(function(){
	    $("#myController").jFlow({
			controller: ".control", // must be class, use . sign
			slideWrapper : "#jFlowSlider", // must be id, use # sign
			slides: "#slider",  // the div where all your sliding divs are nested in
			selectedWrapper: "jFlowSelected",  // just pure text, no sign
			width: "984px",  // this is the width for the content-slider
			height: "480px",  // this is the height for the content-slider
			duration: 400,  // time in miliseconds to transition one slide
			prev: ".slidprev", // must be class, use . sign
			next: ".slidnext", // must be class, use . sign
			auto: true	
		});
	});
  </script>
  <script>
	$(function() {
	  $('#list_product').carouFredSel({
		prev: '#prev_c1',
		next: '#next_c1',
		auto: false
	  });
          $('#list_product2').carouFredSel({
		prev: '#prev_c2',
		next: '#next_c2',
		auto: false
	  });
	  $(window).resize();
	});
  </script>
  <script>
       $(document).ready(function(){
	      $("button").click(function(){
		     $(this).addClass('click')
	      });             
       })
  </script>
  <style type="text/css">
  	.data{
  		display: inline-block;
  		width:100px;
  		margin-left: 20px;
  		margin-top: 10px;
  	}
  	input{
  		margin-left: 20px;
  		margin-top: 10px;
  	}
  	input[type="password"]{
  		height: 33px;
	    padding: 0 10px;
	    border: 1px solid #ccc;
	    color: #777;
	    border-radius: 2px;
  	}
  	/*设置显示隐藏属性*/
  	.no1{
  		display: block;
  	}
  	.no2{
  		display: none;
  	}
  	#user,#pass,#baby,#man,#address{
  		width: 100%;
  	}
  	.max_background{
  		width:100%;
  		height:100%;
  		background: #ccc;
  		z-index:10;
  		position: fixed;
  		top: 0;
  		left: 0;
  		opacity: 0.5;
  	}
  	.add_the_address{
  		width:600px;
  		height:400px;
  		border: 1px solid #000000;
  		position: fixed;
  		left:30%;
  		top: 100px;
  		z-index: 11;
  		background: #fff;
  	}
  	.cancel{
  		display: inline-block;
  		border: 1px solid red;
  		background: red;
  		width:30px;
  		font-size: 25px;
  		height: 25px;
  		text-align: center;
  		color: #F9F9F9;
  		margin-left: 568px;
  	}
  </style>
  
 </head>
<body>
  {include file="index/menu"}
  <div class="clear"></div>
  <hr style="width: 80%;margin-left: 10%;border: 2px solid orangered;" />
  <section id="main">
    <div class="container_12">
       <div id="sidebar" class="grid_3">
	      <aside id="categories_nav">
		     <h3>我的账户</h3>
		     
		     <nav class="left_menu">
			    <ul>
				   <li><button id="user">个人资料</button></li>
				   <li><button id="pass">修改密码</button></li>
				   <li><button id="baby">已买到的宝贝</button></li>
				   <li><button id="man">评价管理</button></li>
				   <li><button id="address">收货地址</button></li>
			    </ul>
		     </nav><!-- .left_menu -->
	      </aside><!-- #categories_nav -->
	      
       </div><!-- .sidebar -->
      <!--
      	右边选项 个人中心
      -->
       <div id="content" class="grid_9 no1">
	      <h1 class="page_title">个人资料</h1>
	      <div class="listing_product">
			<div class="product_li">
				<form onsubmit="return false" enctype="multipart/form-data" id="formfile">
					{foreach $arr as $v}
						<span class="data">账号:</span><input type="text" name="name" value="{$v.name}" disabled/><br /><br />
						<span class="data">头像:</span><input type="file" name="file" value=""/><img src="../../uploads/{$v.imgname}" width="40px"/><br /><br />
						<span class="data">年龄:</span><input type="text" name="age" value="{$v.age}"/><span id="age"></span><br /><br />
						<span class="data">性别:</span><input type="radio" name="sex" value="1" {$v.sex==1?"checked":"";}/>男
													<input type="radio" name="sex" value="0" {$v.sex==0?"checked":"";}/>女<br /><br />
						<span class="data">手机号:</span><input type="text" name="phone" value="{$v.phone}"/><span id="phone"></span><br /><br />
						<span class="data">邮箱:</span><input type="text" name="email" value="{$v.email}"/><span id="email"></span><br /><br />
						<input type="submit" id="update" value="修改" style="padding: 5px 30px;margin-left:120px;"/>
					{/foreach}
				</form>
			</div><!-- .article -->
	      <div class="clear"></div>
	      </div><!-- .listing_product -->
       </div><!-- #content -->
      <!--
      	右边选项 修改密码
      -->
       <div id="content" class="grid_9 no2">
	      <h1 class="page_title">修改密码</h1>
	      <div class="listing_product">
			<div class="product_li">
				<form action="{:url('index/edit')}" method="post">
					{foreach $arr as $v}
						<span class="data">账号:</span><input type="text" name="name" value="{$v.name}" disabled/><br /><br />
						<span class="data">旧密码:</span><input type="password" name="oldpass" value=""/><br /><br />
						<span class="data">新密码:</span><input type="password" name="password" value=""/><br /><br />
						<span class="data">再次确认新密码:</span><input type="password" name="password_confirm" value=""/><br /><br />
						<input type="submit" value="修改密码" style="padding: 5px 30px;margin-left:120px;"/>
					{/foreach}
				</form>
			</div><!-- .article -->
	      <div class="clear"></div>
	      </div><!-- .listing_product -->
       </div><!-- #content -->
       <!--
      	右边选项 已买到的宝贝
      -->
       <div id="content" class="grid_9 no2">
	      <h1 class="page_title">已买到的宝贝</h1>
	      <div class="listing_product">
			<div class="product_li">
				<form action="{:url('index/edit')}" method="post">
					{foreach $arr as $v}
						<span class="data">账号:</span><input type="text" name="name" value="{$v.name}" disabled/><br /><br />
						<span class="data">旧密码:</span><input type="password" name="oldpass" value=""/><br /><br />
						<span class="data">新密码:</span><input type="password" name="password" value=""/><br /><br />
						<span class="data">再次确认新密码:</span><input type="password" name="password_confirm" value=""/><br /><br />
						<input type="submit" value="修改密码" style="padding: 5px 30px;margin-left:120px;"/>
					{/foreach}
				</form>
			</div><!-- .article -->
	      <div class="clear"></div>
	      </div><!-- .listing_product -->
       </div><!-- #content -->
       <!--
      	右边选项 评价管理
      -->
       <div id="content" class="grid_9 no2">
	      <h1 class="page_title">评价管理</h1>
	      <div class="listing_product">
			<div class="product_li">
				<form action="{:url('index/edit')}" method="post">
					{foreach $arr as $v}
						<span class="data">账号:</span><input type="text" name="name" value="{$v.name}" disabled/><br /><br />
						<span class="data">旧密码:</span><input type="password" name="oldpass" value=""/><br /><br />
						<span class="data">新密码:</span><input type="password" name="password" value=""/><br /><br />
						<span class="data">再次确认新密码:</span><input type="password" name="password_confirm" value=""/><br /><br />
						<input type="submit" value="修改密码" style="padding: 5px 30px;margin-left:120px;"/>
					{/foreach}
				</form>
			</div><!-- .article -->
	      <div class="clear"></div>
	      </div><!-- .listing_product -->
       </div><!-- #content -->
       <!--
      	右边选项 收货地址管理
      -->
       <div id="content" class="grid_9 no2">
	      <h1 class="page_title">收货地址管理</h1>
	      <div class="listing_product">
			<div class="product_li">
				<table >
					<tr>
						<th>收货人</th>
						<th>收货地址</th>
						<th>联系方式</th>
						<th>操作</th>
					</tr>
				{foreach $address as $v}
					<tr>
						<td>{$v.username}</td>
						<td>{$v.phone}</td>
						<td>{$v.address}</td>
						<td>
							<button style="display: inline-block;width: 40px;background: #fff;color: #333;">修改</button>
							<button style="display: inline-block;width: 40px;background: #fff;color: #333;">删除</button>
						</td>
					</tr>
				{/foreach}
					<tr><td colspan="4"><button id="ship_address" style="width: 100%;height: 100%;background: #F9F9F9;color: #000000;">添加地址</button></td></tr>
					<tr><td colspan="4">{$address->render()}</td></tr>
				</table>
			</div><!-- .article -->
	      <div class="clear"></div>
	      </div><!-- .listing_product -->
       </div><!-- #content -->
       
       
       
    </div><!-- .container_12 -->
  </section><!-- #main -->
  
  <div class="clear"></div>
  
  {include file="index/menu1"}
  <!--灰色背景-->
  <div id="max"></div>
  <!--添加地址的弹出框-->
  <div class="add_the_address no2">
  	<span class="cancel">X</span>
  	<h3 style="text-align: center;margin-top: 30px;">添加收货地址</h3>
  	<form onsubmit="return false" method="post" id="t_address">
  		<span style="width: 50px;margin-left: 180px;display: inline-block;">姓名:</span><input type="text" name="username" value=""/><br /><br />
	  	<span style="width: 50px;margin-left: 180px;display: inline-block;">手机号:</span><input type="text" name="phone1" value=""/><span id="phone1"></span><br /><br />
	  	<span style="width: 50px;margin-left: 180px;display: inline-block;">地址:</span><input type="text" name="address" value=""/><br /><br />
	  	<input type="submit" id="the_address" value="添加地址" style="padding: 5px 40px;margin-left: 260px;"/>
  	</form>
  	</div>
</body>
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
</html>
<script type="text/javascript">
	//验证年龄格式是否正确
	$('input[name=age]').focusout(function(){
		var age = $(this).val();
		var user_age = /^\d{0,3}$/;
		if(!user_age.test(age)){
			$('#age').text('请输入正确的年龄').attr('style','color:red;');
		}else{
			$('#age').text(' ').attr('style','color:green;');
		}
	})
	//验证手机号格式是否正确
	$('input[name=phone]').focusout(function(){
		var phone = $(this).val();
		var user_phone = /^1[3-9]\d{9}$/;
		if(!user_phone.test(phone)){
			$('#phone').text('请输入正确的手机号').attr('style','color:red;');
		}else{
			$('#phone').text(' ').attr('style','color:green;');
		}
	})
	//验证手机号格式是否正确
	$('input[name=phone1]').focusout(function(){
		var phone = $(this).val();
		var user_phone = /^1[3-9]\d{9}$/;
		if(!user_phone.test(phone)){
			$('#phone1').text('请输入正确的手机号').attr('style','color:red;');
		}else{
			$('#phone1').text(' ').attr('style','color:green;');
		}
	})
	//验证邮箱
	$('input[name=email]').focusout(function(){
		var email = $(this).val();
		var user_email = /^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;
		if(!user_email.test(email)){
			$('#email').text('请输入正确的邮箱').attr('style','color:red;');
		}else{
			$('#email').text(' ').attr('style','color:green;');
		}
	})
	//修改资料
	
	$('#update').click(function(e){
		e.preventDefault();
		if($('#phone').text()=='请输入正确的手机号'||$('#age').text()=='请输入正确的年龄'||$('#email').text()=='请输入正确的邮箱'){
			
			alert(1);
		}else{
			var formdata = new FormData($('#formfile')[0]);
			$.ajax({
				url:"{:url('index/edit_data')}",
				type:"post",
				processData:false,
				contentType:false,
				cache:false,
				data:formdata,
				success:function(res){
					alert(res);
				}
			});
			
		}
	});
	//设置点击切换
	$('#user').click(function(){
		$('.grid_9').eq(0).addClass('no1').removeClass('no2').siblings('.grid_9').addClass('no2').removeClass('no1');
	});
	$('#pass').click(function(){
		$('.grid_9').eq(1).addClass('no1').removeClass('no2').siblings('.grid_9').addClass('no2').removeClass('no1');
	});
	$('#baby').click(function(){
		$('.grid_9').eq(2).addClass('no1').removeClass('no2').siblings('.grid_9').addClass('no2').removeClass('no1');
	});
	$('#man').click(function(){
		$('.grid_9').eq(3).addClass('no1').removeClass('no2').siblings('.grid_9').addClass('no2').removeClass('no1');
	});
	$('#address').click(function(){
		$('.grid_9').eq(4).addClass('no1').removeClass('no2').siblings('.grid_9').addClass('no2').removeClass('no1');
	});
	//设置添加地址
	$('#ship_address').click(function(){
		$('#max').addClass('max_background');
		$('.add_the_address').addClass('no1').removeClass('no2');
	});
	//添加地址提交
	$('#the_address').click(function(){
		if($('#phone1').text()!='请输入正确的手机号'&&$('input[name=username]').val().length>0&&$('input[name=phone1]').val().length>0&&$('input[name=address]').val().length>0){
//			var user = $('input[name=username]').val();
//			var phone = $('input[name=phone1]').val();
//			var address = $('input[name=address]').val();
				var formdata = new FormData($('#t_address')[0]);
			$.ajax({
				type:"post",
				url:"{:url('index/add_address')}",
		    processData: false,
		    contentType: false,
		    cache: false,
		    data:formdata,
//		    data:"username="+user+"&phone="+phone+"&address="+address,
		    success:function(res){
		    	$('.add_the_address').addClass('no2').removeClass('no1');
					$('#max').removeClass()('max_background');
		    }
			});
		}
	});
	//取消添加地址框按钮
	$('.cancel').click(function(){
		$('.add_the_address').addClass('no2').removeClass('no1');
		$('#max').removeClass()('max_background');
	});
</script>